---
title: Charge density
category: Theory
order: 3
---



&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--indentation-->
In order to calculate charge density $$\rho(t_2 )$$, we change the basis from $$\{  \phi_{i\mathbf{k}}(\mathbf{G},t_1) \} $$  to $$\{  \phi_{i\mathbf{k}}(\mathbf{G},t_2) \}$$ ,
![](/formula/2020/04/18-Theory/17.png)
Charge density $$\rho(t_2 )$$ can be calculated with $$c_{i\gamma,\mathbf{k}}^{'}(t_2) $$ and $$\phi_{i\mathbf{k}} (\mathbf{G},t_2 )  $$  as:
![](/formula/2020/04/18-Theory/19.png)
where
![](/formula/2020/04/18-Theory/20.png)
is the population of the adiabatic states.
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!--indentation-->
The initial state of TDKS orbital is the ground state of DFT calculated by *[Quantum Espresso](https://www.quantum-espresso.org/)*, 
![](/formula/2020/04/18-Theory/21.png)